<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8" />

  <title>Eye2AI</title>
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="SitePoint" />
  <link rel="stylesheet" href="{{ url_for('static', filename='base.css')}}" />

  <link rel="stylesheet" href="{{ url_for('static', filename='home.css')}}" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body>
  <div id="main">
    <div id="title_container">
      <h1 id="title">EYE2AI</h1>
      <h2 href="" class="typewrite" id="writer_container" data-period="2000"
        data-type='[ "hi im bhargav.","solutions with machine learning.", "powered by tensorflow.", "i love to develop." ]'>
      </h2>
    </div>
    <div id="container">

      <div class="child">
        <h1>
          Machine Learning Architecture
        </h1>
        <p class="description">
          The machine learning model is based on a Convolutional Neural
          Network (CNN). CNN's are able to parse through an image and extract
          the most important features in an image for prediction through a
          series of Convolutional and Max Pooling layers. The result of these
          layers is a one dimensional layer that is passed to a series of
          dense layers to predict which class the image belongs to. The machine learning model is trained on Optical
          Coherence Tomography (OCT) images trained to detect three different eye diseases: CNV, DME, and Drusen.
        </p>

        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">

          <div class="carousel-inner">
            <div class="carousel-item active">
              <img class="d-block w-100" src="{{ url_for('static', filename='model_accuracy_png.png')}}"
                alt="First slide">
            </div>
            <div class="carousel-item">
              <img class="d-block w-100" src="{{ url_for('static', filename='model_loss_png.png')}}" alt="Second slide">
            </div>

          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>

          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true" "></span>
                                  <span class=" sr-only">Next</span>
          </a>
        </div>

      </div>
      <div id="input" class="child">

        <form method="post" id="upload" enctype="multipart/form-data">
          <label id="apply_label" for="apply">
            <input type="file" name="image" onchange="form.submit()" id="apply" accept=".jpeg, .jpg, .png">
            <h3 id="UploadImage">
              Upload Image
            </h3>
          </label>
        </form>
      </div>





      <div class="child">
        <div class="slider">

          <a href="#slide-1">CNV</a>
          <a href="#slide-2">DME</a>
          <a href="#slide-3">DRU</a>
          <a href="#slide-4">NORM</a>

          <div class="slides">
            <div id="slide-1">
              <img src="{{ url_for('static', filename='images/cnv.png')}}" alt="Choroidal Neovascularization"
                class="slides_image" />
            </div>
            <div id="slide-2">
              <img src="{{ url_for('static', filename='images/dme.jpeg')}}" alt="Diabetic Macular Edema"
                class="slides_image" />
            </div>
            <div id="slide-3">
              <img src="{{ url_for('static', filename='images/drusen.jpeg')}}" alt="Drusen" class="slides_image" />
            </div>
            <div id="slide-4">
              <img src="{{ url_for('static', filename='images/normal.jpeg')}}" alt="Normal Eye" class="slides_image" />
            </div>
          </div>
        </div>
      </div>
      <div class="child">
        <h3 id="conditions">Conditions</h3>
        <div class="description">
          <h3 class="condition_name"><strong>Choroidal Neovascularization (CNV):</strong></h3>
          <div style="margin-left: 8ch;">
            <p>Choroidal Neovascularization (CNV) is a major cause of vision loss and is the creation of new blood
              vessels in the choroid layer of the eye. The choroid supplies oxygen and nutrients to the eye. CNV is a
              common cause of vision loss. The most common cause of CNV is from age-related macular degeneration.</p>
          </div>
          <h3 class="condition_name"><strong>Diabetic Macular Edema (DME):</strong></h3>
          <div style="margin-left: 8ch;">
            <p>Diabetic Macular Edema is caused by ongoing damage to the small blood vessels of the retina. The leakage
              of fluid into the retina may lead to swelling of the surrounding tissue, including the macula. DME is the
              most common cause of vision loss in people with diabetic retinopathy.</p>
          </div>
          <h3 class="condition_name"><strong>Drusen (DRU):</strong></h3>
          <div style="margin-left: 8ch;">
            <p>Drusen are small yellow deposits of fatty proteins (lipids) that accumulate under the retina. The retina
              is a thin layer of tissue that lines the back of the inside of the eye, near the optic nerve. The optic
              nerve connects the eye to the brain. The retina contains light-sensing cells that are essential for
              vision.</p>
          </div>
        </div>
      </div>

    </div>
  </div>
<script src="{{ url_for('static', filename='Parse.js')}}"></script>

  <script src="{{ url_for('static', filename='Chart.js')}}"></script>
  <script>
    var TxtType = function (el, toRotate, period) {
      this.toRotate = toRotate;
      this.el = el;
      this.loopNum = 0;
      this.period = parseInt(period, 10) || 2000;
      this.txt = "";
      this.tick();
      this.isDeleting = false;
    };

    TxtType.prototype.tick = function () {
      var i = this.loopNum % this.toRotate.length;
      var fullTxt = this.toRotate[i];

      if (this.isDeleting) {
        this.txt = fullTxt.substring(0, this.txt.length - 1);
      } else {
        this.txt = fullTxt.substring(0, this.txt.length + 1);
      }

      this.el.innerHTML = '<span id="wrap">' + this.txt + "</span>";

      var that = this;
      var delta = 200 - Math.random() * 100;

      if (this.isDeleting) {
        delta /= 2;
      }

      if (!this.isDeleting && this.txt === fullTxt) {
        delta = this.period;
        this.isDeleting = true;
      } else if (this.isDeleting && this.txt === "") {
        this.isDeleting = false;
        this.loopNum++;
        delta = 500;
      }

      setTimeout(function () {
        that.tick();
      }, delta);
    };

    window.onload = function () {
      var elements = document.getElementsByClassName("typewrite");
      for (var i = 0; i < elements.length; i++) {
        var toRotate = elements[i].getAttribute("data-type");
        var period = elements[i].getAttribute("data-period");
        if (toRotate) {
          new TxtType(elements[i], JSON.parse(toRotate), period);
        }

      }
    };
    console.log("here")
    console.log("val: ")
    const predictionAvailable = "{{ prediction }}";
    console.log(predictionAvailable);
    // const Parse = require("parse");
    $('.carousel').carousel({
      interval: 2000
    })
    Parse.initialize(
      "ZaxZINZF5ulDqaNp2UqrPGwQc6gS8mRNhRerQVdR",
      "BlUFnHbSWUIy0TNsehvyIzVnRm8djNoreOESVNcR"
    );
    Parse.serverURL = 'https://pg-app-9jsnmnx8ggqbaulrcwx2chzgdeusr7.scalabl.cloud/1/';

    if (predictionAvailable == "True") {
      console.log("here")
      // <canvas id="myChart" width="600" height="600"></canvas>
      var ele = document.createElement("canvas");
      ele.id = "myChart";
      ele.width = 500;
      ele.height = 500;
      document.getElementById("input").insertBefore(ele, document.getElementById("upload"));
      var ctx = document.getElementById("myChart").getContext("2d");
      var myChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: ["CNV", "DME", "DRU", "NORMAL"],
          datasets: [
            {
              data: [
                "{{ cnv }}",
                "{{ dme }}",
                "{{ drusen }}",
                "{{ normal }}",
              ],
              backgroundColor: [
                "rgba(255, 99, 132, 0.2)",
                "rgba(54, 162, 235, 0.2)",
                "rgba(255, 206, 86, 0.2)",
                "rgba(75, 192, 192, 0.2)",
                "rgba(153, 102, 255, 0.2)",
                "rgba(255, 159, 64, 0.2)",
              ],
              borderColor: [
                "rgba(255, 99, 132, 1)",
                "rgba(54, 162, 235, 1)",
                "rgba(255, 206, 86, 1)",
                "rgba(75, 192, 192, 1)",
                "rgba(153, 102, 255, 1)",
                "rgba(255, 159, 64, 1)",
              ],
              borderWidth: 1,
            },
          ],
        },
        options: {
          title: {
            display: true,
            text: "Prediction Confidence of Image",
            fontSize: 24,
            fontStyle: "bold",

          },
          scales: {
            yAxes: [
              {
                ticks: {
                  beginAtZero: true,
                },
              },
            ],
          },
          legend: {
            display: false,
          },
        },
      });
    }
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

</body>

</html>